<!DOCTYPE html>
<html>
<head>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .chart-container { margin: 20px 0; padding: 15px; border: 1px solid #ccc; }
        .explanation { background: #f0f8ff; padding: 15px; margin: 15px 0; border-left: 4px solid #0066cc; }
        .code-example { background: #f5f5f5; padding: 10px; border-radius: 5px; margin: 10px 0; }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
</head>
<body>

<h2>ğŸ”§ ä¿®æ­£ç‰ˆï¼šçªè®Šä¿¡è™Ÿ vs æ¼¢å¯§çª—èª¿åˆ¶ä¿¡è™Ÿ</h2>

<div class="chart-container">
<h3>1. å®Œæ•´çš„ä¿¡è™Ÿå°æ¯”ï¼ˆä¿®æ­£ç‰ˆï¼‰</h3>
<canvas id="signalComparison" width="800" height="400"></canvas>
</div>

<div class="explanation">
<strong>åœ–è¡¨èªªæ˜ï¼š</strong><br>
â€¢ <span style="color: red; font-weight: bold;">ç´…ç·š</span>ï¼šçªç„¶é–‹é—œçš„ä¿¡è™Ÿ - æ³¨æ„é‚Šç•Œè™•çš„çªè®Š<br>
â€¢ <span style="color: blue; font-weight: bold;">è—ç·š</span>ï¼šæ¼¢å¯§çª—èª¿åˆ¶çš„ä¿¡è™Ÿ - å¹³æ»‘çš„æ·¡å…¥æ·¡å‡º<br>
â€¢ <span style="color: green; font-weight: bold;">ç¶ ç·š</span>ï¼šæ¼¢å¯§çª—åŒ…çµ¡å‡½æ•¸ - æ§åˆ¶æŒ¯å¹…è®ŠåŒ–<br>
â€¢ <span style="color: orange; font-weight: bold;">æ©™ç·š</span>ï¼šè¼‰æ³¢ä¿¡è™Ÿ - åŸºæœ¬çš„æ­£å¼¦æ³¢
</div>

<div class="chart-container">
<h3>2. é »åŸŸå°æ¯”ï¼ˆæ¨¡æ“¬ï¼‰</h3>
<canvas id="frequencyComparison" width="800" height="300"></canvas>
</div>

<div class="explanation">
<strong>é »åŸŸå·®ç•°ï¼š</strong><br>
â€¢ çªè®Šä¿¡è™Ÿåœ¨é »åŸŸä¸­æœƒç”¢ç”Ÿå¾ˆå¤šæ—ç“£ï¼ˆside lobesï¼‰<br>
â€¢ æ¼¢å¯§çª—èª¿åˆ¶ä¿¡è™Ÿçš„é »è­œæ›´é›†ä¸­ï¼Œæ—ç“£è¼ƒå°<br>
â€¢ é€™å°±æ˜¯ç‚ºä»€éº¼éœ€è¦å¹³æ»‘åŒ…çµ¡çš„åŸå› 
</div>

<div class="chart-container">
<h3>3. FDTDä¸­çš„å¯¦éš›æ‡‰ç”¨</h3>
<canvas id="fdtdApplication" width="800" height="300"></canvas>
</div>

<div class="code-example">
<strong>å°æ‡‰çš„ç¨‹å¼ç¢¼ï¼š</strong>
<pre>
# çªè®Šç‰ˆæœ¬ï¼ˆä¸æ¨è–¦ï¼‰
if q >= start_time and q <= end_time:
    signal = amplitude * sin(2*pi*q/period)
else:
    signal = 0

# æ¼¢å¯§çª—ç‰ˆæœ¬ï¼ˆæ¨è–¦ï¼‰
if q < pulse_duration:
    envelope = hanning_function(q, pulse_duration)
    signal = amplitude * sin(2*pi*q/period) * envelope
else:
    signal = 0
</pre>
</div>

<script>
// 1. ä¿¡è™Ÿå°æ¯”åœ–
const ctx1 = document.getElementById('signalComparison').getContext('2d');

const timePoints = [];
const suddenSignal = [];
const hanningSignal = [];
const envelope = [];
const carrier = [];

const totalPoints = 300;
const pulseStart = 50;
const pulseEnd = 250;
const frequency = 0.05; // è¼‰æ³¢é »ç‡

for (let i = 0; i <= totalPoints; i++) {
    timePoints.push(i);
    
    // è¼‰æ³¢ä¿¡è™Ÿ
    const carrierValue = Math.sin(2 * Math.PI * frequency * i);
    carrier.push(carrierValue);
    
    // çªç„¶é–‹é—œä¿¡è™Ÿ
    let sudden = 0;
    if (i >= pulseStart && i <= pulseEnd) {
        sudden = carrierValue;
    }
    suddenSignal.push(sudden);
    
    // æ¼¢å¯§çª—åŒ…çµ¡
    let env = 0;
    if (i >= pulseStart && i <= pulseEnd) {
        const normalized = (i - pulseStart) / (pulseEnd - pulseStart);
        env = 0.5 * (1 - Math.cos(2 * Math.PI * normalized));
    }
    envelope.push(env);
    
    // æ¼¢å¯§çª—èª¿åˆ¶ä¿¡è™Ÿ
    const hanning = sudden * env;
    hanningSignal.push(hanning);
}

new Chart(ctx1, {
    type: 'line',
    data: {
        labels: timePoints,
        datasets: [
            {
                label: 'çªç„¶é–‹é—œä¿¡è™Ÿ',
                data: suddenSignal,
                borderColor: 'red',
                backgroundColor: 'rgba(255, 0, 0, 0.1)',
                fill: false,
                borderWidth: 2,
                tension: 0
            },
            {
                label: 'æ¼¢å¯§çª—èª¿åˆ¶ä¿¡è™Ÿ',
                data: hanningSignal,
                borderColor: 'blue',
                backgroundColor: 'rgba(0, 0, 255, 0.1)',
                fill: false,
                borderWidth: 2,
                tension: 0
            },
            {
                label: 'æ¼¢å¯§çª—åŒ…çµ¡',
                data: envelope,
                borderColor: 'green',
                backgroundColor: 'rgba(0, 255, 0, 0.1)',
                fill: false,
                borderWidth: 2,
                tension: 0.2
            },
            {
                label: 'è¼‰æ³¢ä¿¡è™Ÿ',
                data: carrier,
                borderColor: 'orange',
                backgroundColor: 'rgba(255, 165, 0, 0.1)',
                fill: false,
                borderWidth: 1,
                tension: 0
            }
        ]
    },
    options: {
        responsive: false,
        interaction: {
            mode: 'index',
            intersect: false,
        },
        scales: {
            x: {
                title: {
                    display: true,
                    text: 'æ™‚é–“æ­¥æ•¸ (q)'
                },
                grid: {
                    display: true
                }
            },
            y: {
                title: {
                    display: true,
                    text: 'æŒ¯å¹…'
                },
                min: -1.2,
                max: 1.2
            }
        },
        plugins: {
            title: {
                display: true,
                text: 'ä¿¡è™Ÿå°æ¯”ï¼šæ¸…æ¥šçœ‹å‡ºæ¼¢å¯§çª—çš„å¹³æ»‘æ•ˆæœ'
            },
            legend: {
                display: true,
                position: 'top'
            }
        }
    }
});

// 2. é »åŸŸå°æ¯”ï¼ˆæ¨¡æ“¬ï¼‰
const ctx2 = document.getElementById('frequencyComparison').getContext('2d');

const frequencies = [];
const suddenSpectrum = [];
const hanningSpectrum = [];

for (let f = 0; f <= 100; f++) {
    frequencies.push(f);
    
    // æ¨¡æ“¬çªè®Šä¿¡è™Ÿçš„é »è­œï¼ˆæœ‰å¾ˆå¤šæ—ç“£ï¼‰
    const centerFreq = 20;
    let suddenPower = Math.exp(-0.1 * Math.abs(f - centerFreq));
    
    // æ·»åŠ æ—ç“£
    if (f !== centerFreq) {
        suddenPower += 0.3 * Math.exp(-0.05 * Math.abs(f - centerFreq)) * 
                     Math.abs(Math.sin(0.3 * (f - centerFreq)));
    }
    suddenSpectrum.push(suddenPower);
    
    // æ¨¡æ“¬æ¼¢å¯§çª—ä¿¡è™Ÿçš„é »è­œï¼ˆæ›´é›†ä¸­ï¼‰
    let hanningPower = Math.exp(-0.2 * Math.abs(f - centerFreq));
    
    // è¼ƒå°çš„æ—ç“£
    if (f !== centerFreq) {
        hanningPower += 0.1 * Math.exp(-0.1 * Math.abs(f - centerFreq)) * 
                       Math.abs(Math.sin(0.5 * (f - centerFreq)));
    }
    hanningSpectrum.push(hanningPower);
}

new Chart(ctx2, {
    type: 'line',
    data: {
        labels: frequencies,
        datasets: [
            {
                label: 'çªè®Šä¿¡è™Ÿé »è­œ',
                data: suddenSpectrum,
                borderColor: 'red',
                fill: true,
                backgroundColor: 'rgba(255, 0, 0, 0.3)',
                tension: 0.1
            },
            {
                label: 'æ¼¢å¯§çª—ä¿¡è™Ÿé »è­œ',
                data: hanningSpectrum,
                borderColor: 'blue',
                fill: true,
                backgroundColor: 'rgba(0, 0, 255, 0.3)',
                tension: 0.1
            }
        ]
    },
    options: {
        responsive: false,
        scales: {
            x: { title: { display: true, text: 'é »ç‡' } },
            y: { title: { display: true, text: 'åŠŸç‡å¯†åº¦' } }
        },
        plugins: {
            title: { display: true, text: 'é »åŸŸå°æ¯”ï¼šæ¼¢å¯§çª—æ¸›å°‘äº†ä¸éœ€è¦çš„é »ç‡æˆåˆ†' }
        }
    }
});

// 3. FDTDæ‡‰ç”¨ç¤ºä¾‹
const ctx3 = document.getElementById('fdtdApplication').getContext('2d');

const fdtdTime = [];
const pulseSignal = [];
const continuousSignal = [];

for (let q = 0; q <= 200; q++) {
    fdtdTime.push(q);
    
    // é€£çºŒæ³¢ä¿¡è™Ÿ
    const continuous = Math.sin(2 * Math.PI * q / 25);
    continuousSignal.push(continuous);
    
    // è„ˆè¡ä¿¡è™Ÿï¼ˆ5å€‹é€±æœŸçš„æ¼¢å¯§çª—ï¼‰
    let pulse = 0;
    const cycles = 5;
    const period = 25;
    const totalDuration = cycles * period;
    
    if (q <= totalDuration) {
        const env = 0.5 * (1 - Math.cos(2 * Math.PI * q / totalDuration));
        pulse = Math.sin(2 * Math.PI * q / period) * env;
    }
    pulseSignal.push(pulse);
}

new Chart(ctx3, {
    type: 'line',
    data: {
        labels: fdtdTime,
        datasets: [
            {
                label: 'é€£çºŒæ³¢ (CW)',
                data: continuousSignal,
                borderColor: 'green',
                fill: false,
                borderWidth: 1
            },
            {
                label: 'è„ˆè¡ (5é€±æœŸæ¼¢å¯§çª—)',
                data: pulseSignal,
                borderColor: 'purple',
                fill: false,
                borderWidth: 2
            }
        ]
    },
    options: {
        responsive: false,
        scales: {
            x: { title: { display: true, text: 'æ™‚é–“æ­¥æ•¸ q' } },
            y: { title: { display: true, text: 'æºä¿¡è™ŸæŒ¯å¹…' } }
        },
        plugins: {
            title: { display: true, text: 'FDTDä¸­çš„å¯¦éš›æ‡‰ç”¨ï¼šé€£çºŒæ³¢ vs è„ˆè¡' }
        }
    }
});
</script>

<div class="explanation">
<h3>ğŸ¯ é—œéµç†è§£è¦é»ï¼š</h3>
<strong>ç‚ºä»€éº¼éœ€è¦æ¼¢å¯§çª—ï¼Ÿ</strong><br>
1. <strong>é »åŸŸç´”æ·¨</strong>ï¼šé¿å…çªè®Šç”¢ç”Ÿçš„é«˜é »å™ªè²<br>
2. <strong>æ•¸å€¼ç©©å®š</strong>ï¼šå¹³æ»‘è®ŠåŒ–æ¸›å°‘FDTDä¸­çš„æ•¸å€¼éœ‡ç›ª<br>
3. <strong>ç‰©ç†çœŸå¯¦</strong>ï¼šçœŸå¯¦çš„é›·å°„å™¨ä¸å¯èƒ½ç¬é–“é–‹é—œ<br>
4. <strong>é‚Šç•Œæ•ˆæ‡‰</strong>ï¼šæ¸›å°‘èˆ‡PMLç­‰é‚Šç•Œæ¢ä»¶çš„äº¤äº’ä½œç”¨å•é¡Œ<br><br>

<strong>ä»€éº¼æ™‚å€™ä½¿ç”¨ï¼Ÿ</strong><br>
â€¢ âœ… <strong>è„ˆè¡æº</strong>ï¼šéœ€è¦æœ‰é™é•·åº¦çš„ä¿¡è™Ÿæ™‚<br>
â€¢ âœ… <strong>é »åŸŸåˆ†æ</strong>ï¼šéœ€è¦ä¹¾æ·¨é »è­œæ™‚<br>
â€¢ âŒ <strong>é€£çºŒæ³¢</strong>ï¼šéœ€è¦ç©©æ…‹ä¿¡è™Ÿæ™‚ä¸ä½¿ç”¨åŒ…çµ¡<br>
â€¢ âŒ <strong>é•·æ™‚é–“æ¨¡æ“¬</strong>ï¼šå·²ç¶“é”åˆ°ç©©æ…‹å¾Œä¸éœ€è¦
</div>

</body>
</html>